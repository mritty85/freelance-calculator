# RateProfiles Sheet Schema

## Purpose
Stores hourly rate calculations derived from budget profiles

## Sheet Name
`RateProfiles`

## Columns

| Column | Name | Type | Description | Example |
|--------|------|------|-------------|---------|
| A | rateProfileId | String | Unique rate profile ID | `rate_m1n2o3p4` |
| B | budgetProfileId | String | Reference to BudgetProfiles | `budget_x1y2z3w4` |
| C | calculatedAt | ISO DateTime | When rate was calculated | `2025-01-15T10:40:00.000Z` |
| D | hoursPerWeek | Number | Billable hours per week | `25` |
| E | weeksPerYear | Number | Working weeks per year | `48` |
| F | realisticHours | Number | Realistic annual billable hours | `1020` |
| G | minimumRate | Number | Minimum hourly rate | `133` |
| H | recommendedRate | Number | Recommended hourly rate | `146` |
| I | walkAwayRate | Number | Walk-away minimum rate | `80` |
| J | fullDataJSON | JSON String | Complete rate calculation | `{...}` |

## Row 1 (Headers)
```
rateProfileId | budgetProfileId | calculatedAt | hoursPerWeek | weeksPerYear | realisticHours | minimumRate | recommendedRate | walkAwayRate | fullDataJSON
```

## Sample Data Row
```
rate_m1n2o3p4 | budget_x1y2z3w4 | 2025-01-15T10:40:00.000Z | 25 | 48 | 1020 | 133 | 146 | 80 | {...}
```

## fullDataJSON Schema
```javascript
{
  "budgetProfileId": "budget_x1y2z3w4",
  "calculatedAt": "2025-01-15T10:40:00.000Z",

  "grossIncomeNeeded": 135570,
  "desiredTakeHome": 66000,

  "workingHours": {
    "hoursPerWeek": 25,
    "weeksPerYear": 48,
    "rawAnnual": 1200,
    "realisticAnnual": 1020,
    "bufferApplied": 15
  },

  "rates": {
    "minimum": 133,
    "recommended": 146,
    "walkAway": 80,

    "projectRates": [
      { "hours": 20, "minimumProject": 2660, "recommendedProject": 2920 },
      { "hours": 40, "minimumProject": 5320, "recommendedProject": 5840 },
      { "hours": 80, "minimumProject": 10640, "recommendedProject": 11680 },
      { "hours": 160, "minimumProject": 21280, "recommendedProject": 23360 }
    ]
  },

  "explanation": {
    "minimumRate": "Minimum to hit your $135,570 gross goal",
    "recommendedRate": "Includes 10% negotiation buffer",
    "walkAwayRate": "Absolute minimum - below this you're working at a loss"
  }
}
```

## Notes
- rateProfileId is auto-generated by SheetsDB.gs
- Each budget profile can have multiple rate profiles (different hour assumptions)
- Columns D-I are duplicated from JSON for easy querying/sorting
- Use fullDataJSON for complete data, use columns for quick filtering

## Indexing
- Primary key: rateProfileId (Column A)
- Foreign key: budgetProfileId (Column B) â†’ BudgetProfiles.budgetProfileId
- Sort by: calculatedAt (Column C) descending

## Data Retention
- Keep all rate profiles for history
- Allow users to compare different hour scenarios
- No automatic deletion in MVP
